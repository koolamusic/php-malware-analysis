# Mr.Dr3awe's IndoXploit variant

Mr.Dr3awe seems to have been busy:

* [Defacing](http://goldengatepk.com/)
* [More defacing](https://www.zone-h.org/archive/notifier=Mr.Dr3awe)
* Doing a little [relaxing phishing](https://www.grahamcluley.com/paypal-phished-selfie/)
* Knocking out [some code](https://pastebin.com/Hqtm1ds9)

This web shell can also be had from [pastebin](https://pastebin.com/VuuXiuWj), too.
That paste is dated 2017-07-30.

## Origin

### IP Address 197.48.152.23

197.48.152.23 has DNS name host-197.48.152.236.tedata.net

There's no DNS A record for host-197.48.152.236.tedata.net, however.

    inetnum:        197.48.0.0 - 197.55.255.255
    netname:        All-22
    descr:          TE Data
    country:        EG
    address:        94 Tahrir Street, Dokki, 12311, Giza, Egypt
    route:          197.48.128.0/18
    descr:          Telecom-Egypt-Data
    origin:         AS8452


### Download

Apparently the attacker(s) thought they were accessing
a Web Shell by oRb, "WSO" or "FilesMan" web shell.


|Name | Value|
|-----|------|
|a|FilesMAn|
|c|/var/www/html/|
|p1|uploadFile|

The HTTP parameters are exactly what WSO expects for a file upload,
and the attackers sent along a file named `px.php`

A few requests earlier, attacker(s) logged in to WSO with
a password of "nhzgrf", a common WSO password.
This request arrived with a WSO previously-logged-in cookie
from that login.

The attackers did no recon of my honey pot,
they logged in on the first access.
That first access was the first time my honey pot has ever
seen 197.48.152.23.
This means they probably purchased an alleged WSO url and password somewhere.
They didn't do any real hacking, they just bought illicit digital goods.

## Analysis

No decoding or deobfuscating necessary - it arrived as cleartext,
an MS-DOS format HTML file with embedded PHP.
I did [pretty-print it](f1.php) for readability.

It's just an [IndoXploit](https://github.com/bediger4000/IndoXploit)
knock off.

There's a large comment block in the PHP:

    // Thanks buat Orang-orang yg membantu dalam proses pembuatan shell ini.
    // Shell ini tidak sepenuhnya 100% Coding manual, ada beberapa function dan tools kita 
    // Tapi Selebihnya, itu hasil kreasi Mr.Dr3awe sendiri.
    // Tanpa kalian kita tidak akan BESAR seperti sekarang.
    // Greetz: All Member Mr.Dr3awe. & all my friends.


Google translate will turn that Indonesian into:

> Thanks for those who help in the process of making this shell.
> This shell is not completely 100%. Manual coding, there are several
> functions and tools. But the rest, the results of Mr.Dr3awe's own
> creation. Without you we won't be BIG like now

Apparently Mr.Dr3awe is Indonesian.

### Indonesian Function Names

The indispensible Google Translate gives some hints about
Indonesian function names:

	function ambilKata: "take the word"
    function sabun_massal: "bulk soap"
    function sabun_biasa:  "ordinary soap
    function hapus_massal: "delete bulk"
    function cek: "check", as in traveler's check, check out or examine
