# Second Attack

I happened to notice a second version of the same link injector attack.
The same IP address, 202.178.125.156, tried to do a WSO download, but
to a different URL.

* Sept 10 download: `/phparasites/wp-content/themes/twentytwelve/footer.php`
* Sept 22 download: `/wp-content/themes/twentytwelve/footer.php`

The `/phparasites` part of the first URL is for real,
my WordPress honey pot documentation resides at that URL.
It's possible for entities to delude themselves into believing or acting like
a WordPress blog lives at that URL, because the Apache `mod_rewrite` I've
got in place to act like a blog is fairly loose about what it accepts as
a WordPress URL, and even looser about what it accepts as a WSO URL.

## Analysis

The injector code looks to be unchanged.
It still tries to insert a configurable piece of HTML into ".php", ".html" or other
files that could conceivably contain HTML that gets rendered to browsers.

### JavaScript 1.js

The HTML that gets injected still contains a `<script>` tag that would cause a browser
to download [http://www.88885333.com/1.js](1.js) . `1.js` remains unchanged.
It redirects a good proportion of requests referred by search engines
to `http://www.p99.cool/`.

If you, as a human, use a web browser to look up something, say "Cash Bodog Sports Network"
in a search engine, then click on a result that has this injected HTML,
you'd get redirected to `http://www.p99.cool/`.
Any human just accessing the blog probably would just see the blog page(s).
It's really fairly clever.

### Injected HTML

The injected HTML looks similar to the September 10th version,
except that the HTML entities for Chinese characters got messed up.

The entities in the Sept 10 HTML Have this format: `&#x53CB;`

The entities in the Sept 22 HTML Have a format like this: `&3x53CB;`

That is, instead of an '#" (octothorpe) there's a digit character.
This causes browsers to not recognize the strings as HTML entities.
I think this will ruin the keywords that the attackers seem to
want to get into search engines.
My first thought is that this is a UTF-something encoding
problem. Some bits leak from the UTF encoding into the 
string for the entity-encoded Unicode code point, but I don't
know for sure.

### SEO Linked-to Domain names

Even though the injected HTML contains a number of links,
the linked-to-web sites are only part of the scam,
not the scam itself.
They exist to get people referred to the compromised WordPress blog,
after which `1.js` sends browsers to the ultimate destination.

There's 60 domain names linked-to in this iteration,
where the previous attack had 77 domain names.

|     |     |     |     |
|-----|-----|-----|-----|
|www.wahooco.com|www.zxkL98.com|www.huade.org|www.shzfpa.com|
|www.hntscm.com|www.zc1718.com|www.zjdqgy.com|www.xzsfs.net|
|www.zznj8.com|www.good-o2.com|www.cn-msh.com|www.synmkj.com|
|www.hljpts.com|www.sjznbgyq.com|www.anjiya.com|www.youthsh.com|
|www.xmyh168.com|www.njtymg.com|www.58szxg.com|www.nbhxpm.com|
|www.mhgyp.com|www.yfyf68.com|www.51cgj.com|www.51zgrl.com|
|www.lcd-1.com|www.gzbowin.com|www.qhdjrfw.com|www.ou-te.com|
|www.qifenge.com|www.gebreakers.com|www.tcldy.com|www.hsghxj.com|
|www.astujue.com|www.shkunLe.com|www.henangt.com|www.xxswsj.com|
|www.szbxzs.com|www.nawatv.com|www.cnycyj.com|www.jd8.cc|
|www.bnwsjds.com|www.cdbzyg.com|www.yc13z.com|www.lwsjxx.com|
|www.hnhtkj.net|www.simodj.com|www.bhhzdx.net|www.fsgfhh.com|
|www.dl20gz.com|www.gxbc.net|www.travelcq.com|www.bjdffl.com|
|www.chenjiagou.cc|www.sxczzx.com|www.jsyxlxj.com|www.zgjjsw.com|
|www.hkshaolin.com|www.ftkbo1.com|www.sxrsj.net|www.tjhbsb.com|

51 of the domain names appear in both pieces of injected HTML.
