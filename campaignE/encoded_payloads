#!/bin/bash
rm -rf payloads
mkdir payloads
for FNAME in \
	'198.57.247.159W@a0H69eIgKEL77YQTVpoAAAAAo.php.file' \
	'47.91.246.242W@a0IQ3PB6KM5NdlyfL3zgAAAAU.php.file' \
	'69.89.31.63W@a0IjA9-lUJttb2WJlNsQAAAAg.php.file' \
	'160.153.154.25W@a0I10Ut9Ld76-fgY7P4gAAAAE.php.file' \
	'50.87.144.83W@a0JQ3PB6KM5NdlyfL3zwAAAAU.php.file' \
	'82.223.18.202W@a0JyUuUsrSrCVG07sjvAAAAAA.php.file' \
	'201.49.197.2W@a0KjA9-lUJttb2WJlNsgAAAAg.php.file' \
	'162.223.89.194W@a0K69eIgKEL77YQTVpogAAAAo.php.file' \
	'114.119.5.11W@a0Ll0Ut9Ld76-fgY7P4wAAAAE.php.file' \
	'103.43.46.26W@a0MCUuUsrSrCVG07sjvQAAAAA.php.file' \
	'192.185.83.204W@a0MicUdXDbBU8zm-daHAAAAAQ.php.file' \
	'160.153.153.30W@a0MzA9-lUJttb2WJlNswAAAAg.php.file'
do
	echo $FNAME
	IPADDR=$(echo $FNAME | sed 's/W..*$//')
	grep '^\$payload_file' files/$FNAME > payloads/$IPADDR
done

for FNAME in payloads/*
do
	ex $FNAME <<END_EDITS
0a
<?php
.
$p
a
print(urldecode(\$payload_file));
.
w!
q
END_EDITS

rm -rf decoded_payloads
mkdir decoded_payloads
for FNAME in payloads/*
do
	IPADDR=$(basename $FNAME)
	php $FNAME > decoded_payloads/$IPADDR
done

done
