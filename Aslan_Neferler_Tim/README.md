# Hacked by Aslan Neferler Tim

![Turkish Hacker in a hoodie](https://github.com/bediger4000/php-malware-analysis/raw/master/Aslan_Neferler_Tim/images/Z9b48Z.jpg "oh, noes!")

A 304 second, human-driven campaign to deface a WordPress web site.

Apparently "Aslan Neferler Tim" roughly translates as
"Lion Soldier Team".
Are "Lion Soldiers" a thing in Turkey?
Is there a concept that would better encapsulate the meaning in English?
Let [me](mailto:bediger8@gmail.com) know!

Aslan Neferler Tim has done the [same thing](https://bitsandscrews.com/solved-get-hacked-aslan-neferler-tim-national-force/)
in the past.

## Origin

### IP Address 85.107.162.94

85.107.162.94 is just another TurkTelecom IP address.

85.107.162.94 reverse lookups as 85.107.162.94.dynamic.ttnet.com.tr

It lives in a TurkTelecom Address space.

    % Information related to '85.107.128.0/17AS47331'
    route:          85.107.128.0/17
    descr:          Turk_Telekom
    origin:         AS47331
    mnt-by:         AS9121-MNT
    created:        2016-09-06T11:14:19Z
    last-modified:  2016-09-06T11:14:19Z

    % Information related to '85.107.128.0/17AS9121'
    route:          85.107.128.0/17
    descr:          TurkTelecom
    origin:         AS9121
    mnt-by:         AS9121-MNT
    created:        2005-10-25T06:00:44Z
    last-modified:  2005-10-25T06:00:44Z

`traceroute` agrees: routes to 85.107.162.94 go to Turkey.

A.N.T.'s browser send a language string: "tr-TR,tr;q=0.8,en-US;q=0.6,en;q=0.4".
That lines up with the TurkTelecom and "Aslan" part, which is Turkish for "lion",
not just the name of a fictional deity.

`p0f` says that Windows XP runs that IP address.

Oddly, the user agent agrees: `Mozilla/5.0 (Windows NT 5.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/49.0.2623.110 Safari/537.36 OPR/36.0.2130.65`

Apparently Windows XP referred to itself as "Windows NT 5.1" internally.

### Download

This is more of a campaign, and less of a unitary "download".

A.N.T. carried out their interactions via a mix
of WordPress and WSO invocations.

## Analysis

### Pluging Update

A [plugin update attempt](85.107.162.94W6R9Y51w@Xt8kV-UakClggAAAA4.plugin-editor.scans)
contained slightly obfuscated (one layer of PHP '\xNNN' strings, only layer of base64-encoding)

